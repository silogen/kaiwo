apiVersion: chainsaw.kyverno.io/v1alpha1
kind: Test
metadata:
  name: kaiwojob-job-label-reconciliation
spec:
  timeouts:
    cleanup: 90s
  steps:
    - try:
        - apply:
            resource:
              apiVersion: batch/v1
              kind: Job
              metadata:
                name: job-with-label-2
                labels:
                  kaiwo.silogen.ai/managed: "true"
              spec:
                template:
                  spec:
                    containers:
                      - name: test-container
                        image: busybox:latest
                        command: ["sleep", "10"]
                    restartPolicy: Never
        - assert:
            resource:
              apiVersion: kaiwo.silogen.ai/v1alpha1
              kind: KaiwoJob
              metadata:
                name: job-with-label-2
              status:
                Status: RUNNING
      catch:
        - events: {}
        - podLogs: {}