# This is an autogenerated test, do not edit

apiVersion: chainsaw.kyverno.io/v1alpha1
kind: Test
metadata:
  name: basic-jobs--jobs-run-to-completion--batch-job
spec:
  steps:
    - catch:
        - command:
            args:
              - tests
              - debug
              - chainsaw
              - --namespace=$NAMESPACE
              - --print-level=$PRINT_LEVEL
            entrypoint: kaiwo
            env:
              - name: NAMESPACE
                value: $(namespace)
              - name: PRINT_LEVEL
                value: $(values.print_level)
      try:
        - apply:
            resource:
              apiVersion: kaiwo.silogen.ai/v1alpha1
              kind: KaiwoJob
              metadata:
                name: basic-jobs--jobs-run-to-completion--batch-job
              spec:
                entrypoint: sleep 5
                image: busybox:latest
                resources:
                  limits:
                    cpu: "1"
                    memory: 2Gi
                  requests:
                    cpu: "1"
                    memory: 2Gi
                user: test-user
          description: |-
            given: the job is a batch job
            when: the job finishes after execution
        - assert:
            resource:
              apiVersion: kaiwo.silogen.ai/v1alpha1
              kind: KaiwoJob
              metadata:
                name: basic-jobs--jobs-run-to-completion--batch-job
              status:
                status: FAILED
          description: |-
            given: the job is a batch job
            when: the job finishes after execution
