apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
- merged.yaml

patches:
- path: ci-patches.yaml

# Exclude ServiceMonitor from CI/test deployments
# The monitoring.coreos.com/v1 CRD is not installed in test environments
# (similar to how the Helm chart doesn't include ServiceMonitor)
- patch: |-
    $patch: delete
    apiVersion: monitoring.coreos.com/v1
    kind: ServiceMonitor
    metadata:
      name: kaiwo-controller-manager-metrics-monitor
      namespace: kaiwo-system
