apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/name: kaiwo
    app.kubernetes.io/managed-by: kustomize
  name: manager-role
rules:
- apiGroups: [""]
  resources:
  - pods
  - pods/log
  - services
  - configmaps
  - secrets
  - events
  - persistentvolumeclaims
  - namespaces
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

- apiGroups: [""]
  resources:
  - nodes
  verbs: ["get", "list", "watch", "update", "patch"]

- apiGroups: ["kaiwo.silogen.ai"]
  resources:
  - "kaiwojobs"
  - "kaiwoqueueconfigs"
  - "kaiwoservices"
  - "clustermodels"
  - "modelcaches"
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

- apiGroups: ["aim.silogen.ai"]
  resources:
  - "aimimages"
  - "aimclusterimages"
  - "aimruntimeconfigs"
  - "aimclusterruntimeconfigs"
  - "aimservicetemplates"
  - "aimclusterservicetemplates"
  - "aimtemplatecaches"
  - "aimservices"
  - "modelcaches"
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

- apiGroups: ["config.kaiwo.silogen.ai"]
  resources:
  - "kaiwoconfigs"
  - "aimnamespaceconfigs"
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

- apiGroups: ["serving.kserve.io"]
  resources:
  - "clusterservingruntimes"
  - "servingruntimes"
  - "inferenceservices"
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

- apiGroups: ["gateway.networking.k8s.io"]
  resources:
  - "httproutes"
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

- apiGroups: ["aim.silogen.ai"]
  resources:
  - "aimimages/status"
  - "aimclusterimages/status"
  - "aimservicetemplates/status"
  - "aimclusterservicetemplates/status"
  - "aimtemplatecaches/status"
  - "aimservices/status"
  - "modelcaches/status"
  verbs: ["get", "update", "patch"]

- apiGroups: ["gateway.networking.k8s.io"]
  resources:
  - "httproutes/status"
  verbs: ["get"]

- apiGroups: ["serving.kserve.io"]
  resources:
  - "clusterservingruntimes/status"
  - "servingruntimes/status"
  - "inferenceservices/status"
  verbs: ["get", "update", "patch"]

- apiGroups: ["kaiwo.silogen.ai"]
  resources:
  - "kaiwojobs/status"
  - "kaiwoservices/status"
  - "kaiwoqueueconfigs/status"
  - "clustermodels/status"
  - "modelcaches/status"
  verbs: ["get", "update", "patch"]

- apiGroups: ["batch"]
  resources: ["jobs"]
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

- apiGroups: ["ray.io"]
  resources: ["rayjobs"]
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

- apiGroups: ["kueue.x-k8s.io"]
  resources:
  - "resourceflavors"
  - "clusterqueues"
  - "localqueues"
  - "workloads"
  - "admissionchecks"
  - "workloadpriorityclasses"
  - "topologies"
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

- apiGroups: ["apiextensions.k8s.io"]
  resources:
  - customresourcedefinitions
  verbs: ["get", "list", "watch"]

- apiGroups: ["rbac.authorization.k8s.io"]
  resources:
  - roles
  - rolebindings
  verbs: ["get", "list", "watch"]
- apiGroups: ["apps"]
  resources: ["deployments"]
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

- apiGroups: ["ray.io"]
  resources: ["rayservices"]
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

- apiGroups: ["workload.codeflare.dev"]
  resources: ["appwrappers"]
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

# Leader election permissions
- apiGroups: ["coordination.k8s.io"]
  resources: ["leases"]
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

# Validate storageclass
- apiGroups: ["storage.k8s.io"]
  resources: ["storageclasses"]
  verbs: ["get"]